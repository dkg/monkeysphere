# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4
# $Id$

PortSystem          1.0
name                monkeysphere
version             0.24
categories          net security
maintainers         nomaintainer
description         use the OpenPGP web of trust to verify ssh connections
long_description    SSH key-based authentication is tried-and-true, \
                    but it lacks a true Public Key Infrastructure for \
                    key certification, revocation and expiration. \
                    Monkeysphere is a framework that uses the OpenPGP \
                    web of trust for these PKI functions.  It can be \
                    used in both directions: for users to get \
                    validated host keys, and for hosts to authenticate \
                    users.
homepage            http://web.monkeysphere.info/
platforms           darwin

depends_run         bin:ssh:openssh \
                    port:gnupg \
                    port:perl5.10 \
                    port:p5-crypt-rsa \
                    port:p5-digest-sha1 \
                    port:procmail

master_sites        http://archive.monkeysphere.info/debian/pool/monkeysphere/m/monkeysphere/
distname            ${name}_${version}
extract.suffix      .orig.tar.gz
worksrcdir          ${name}-${version}
checksums           md5 8590532f4702fa44027a6a583657c9ef

patch.dir           ${worksrcpath}
patch.cmd           make
patch.args          -f Makefile \
                    WRKSRC=${worksrcpath} \
                    SYSETCDIR=${destroot}${prefix}/etc/monkeysphere \
                    SYSDATADIR=${destroot}${prefix}/var/db/monkeysphere \
                    SYSSHAREDIR=${destroot}${prefix}/share/monkeysphere \
                    post-patch

use_configure       no

destroot.destdir    DESTDIR=${destroot}${prefix}
destroot.args       PREFIX=

# variant to use the port version of bash, which may be much newer
# than the one provided by the system
variant port-bash description {use port version of Bash} {
    depends_run-append port:bash
}
