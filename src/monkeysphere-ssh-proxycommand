#!/bin/sh -e

# MonkeySphere ssh ProxyCommand hook
# Proxy command script to initiate a monkeysphere known_hosts update
# before an ssh connection to host is established.
# Can be added to ~/.ssh/config as follows:
# ProxyCommand monkeysphere-ssh-proxycommand %h %p

HOST="$1"
PORT="$2"

# update the known_hosts file for the host
monkeysphere update-known-hosts "$HOST"

# make a netcat connection to host for the ssh connection
exec nc "$HOST" "$PORT"
